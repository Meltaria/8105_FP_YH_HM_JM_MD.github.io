---
title: "Explore our Data"
subtitle: "(NHANES, 2017 - Mar. 2020)"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(viridis)
library(haven)
library(readxl)
library(shiny)
library(plotly)
## Loading required package: viridisLite



```


```{r data, include=FALSE}

load(file = "merged_nhanes.RData")


nhanes_shiny = 
  nhanes

#saving this as an object in order to provide separation between nhanes data and any further data manipulation

```

Settings {.sidebar}
-----------------------------------------------------------------------

```{r, echo = FALSE}
ins_yesno = nhanes_shiny %>% distinct(insany) %>% pull()
edu = nhanes_shiny %>% distinct(educat) %>% pull()
sex = nhanes_shiny %>% distinct(gender) %>% pull()
race = nhanes_shiny %>% distinct(race) %>% pull()

radioButtons(
  inputId = "insurance_any",
  label = h3("Any Insurance Coverage"),
  choices = ins_yesno
)

radioButtons(
  inputId = "sex_bin",
  label = h3("Sex (M/F)"),
  choices = sex
)

selectInput(
  inputId = "race_cat",
  label = h3("Race (as coded in NHANES)"), 
  choices = race
)

selectInput(
  inputId = "edu_cat",
  label = h3("Education Level"), 
  choices = edu
)


```

Column {data-width=650}
-----------------------------------------------------------------------

### Hep B Vaccination Status

```{r, echo = FALSE}

renderPlotly({
  nhanes_shiny %>% 
  filter(insany == input[["insurance_any"]],
         gender == input[["sex_bin"]],
         race == input[["race_cat"]],
         educat == input[["edu_cat"]]
         ) %>% 
  count(hepbvax) %>% 
  mutate(hepbvax = fct_reorder(hepbvax, n)) %>% 
  plot_ly(x = ~hepbvax, y = ~n, color = ~hepbvax, type = "bar")
})

  
```

Column {data-width=350}
-----------------------------------------------------------------------

### History of Hep B

```{r}

```

### History of Hep C

```{r}

```

